# Notes on backend changemaker implementation

We're going to need to add significantly to changemaker in order to enable the generationOn website to succeed. These additions, coupled with what's coming from our third-party partner, give us an opportunity to create additional abstract functionality that can be used organization-wide for purposes other than generationOn. This document is intended to help create that documentation/specifications for the changes/updates to changemaker as it relates to GenOn. This documentation will evolve, and it's current state is "placeholder" at best.

## Service API
The service tracker is a challenging implementation because different kinds of service trackers have different level of information gathering requirements. Therefore we need to determine what kinds of information are always (or at least very frequently) required and which kinds are optional, as well as what kinds of structures we expect reports to come from. 

For instance, PVSA tracks a user, and their hours. Those hours may be reported by the user, or on a user's behalf from a third party organization. The GenerationOn service tracker is a multi-stage process that tracks clubs, project names, project descriptions, its dates, the number of hours broken down by youth and adults, related causes, and asks for impact, story, and participation.

These kinds of differences in service tracking can be difficult to process, and developing a generic archiecture may be very difficult. But at its base, we're always interested in either a person or a project, and the number of hours (probably stored in minutes) of service generated by the person or project. We are also interested in whether or not that service is associated with a particular organization -- either an active points of light participant, or an organization we've not worked with yet. And finally, we're interested in the source program from Points of Light through which it is being reported (e.g. PVSA, GenOn, FOC, etc). We should also collect whether or not it is in service of a service event like the MLK Day of Service or National Volunteer week.

#### Initial Sketch of Hours Table:

| Name           | Type            | Notes.              |
|----------------|-----------------|---------------------|
| UserID         | Int             | FK to users         |
| ProgramID      | Int             | FK To Programs      |
| OpportunityID  | Int             | FK to Opportunities |
| StartOfService | DateTime        |                     |
| EndOfService   | DateTime        |                     |
| serviceMinutes | Integer         |                     |
| UserOrgsID.    | Integer         | Service HABTM Orgs  |
| IsApproved     | Boolean         |                     |
| OtherData      | JSON            |                     |
| Description    | TEXT            |                     |
| StoryID        | Int             | Do we need this?    |

So -- the idea here to de-normalize things that are useful for summary/aggregate reports (dates of service and numbers of hours), normalize things that are already normalized, and create space in the table for machine readable data that is unique to the record but isn't going to be in any particular report outside of the individual record. 

Each record on this table should constitute one record of service, even if someone is volunteering for the same opportunity multiple times. StartOfService should be the start of service for that record of service. 

## Story API

There is also a generic need to capture stories. Stories can be related to tracked service hours, projects, or collected on their own through story-gathering campaigns. Because stories are a necessity of some of the GenOn service trackers it will need to be built out here as well. 

## Organizations Changes
We will need to begin to collect information on organizations that someone volunteered for that may not be registered by points of light or have a presence with us. Creating a flag in the organization so that these organizations.

## COPPA/Birthday/Auth flow changes
We're going to need to start collecting birthdates and be coppa compliant with our auth workflows. This will likely need to be in all auth workflows systemwide. 

## Auth client/October
We'll need to build into October a way to use Changemaker's authentication system to put some information/pages behind a login. 